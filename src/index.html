<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0"
    />
    <title>GeneXus Web Controls Library test page</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.bundle.min.js"></script>
    <script type="module" src="/build/gx-web-controls.esm.js"></script>
    <script nomodule src="/build/gx-web-controls.js"></script>
    <style>
      #chartContainer {
        width: 100%;
        height: auto;
        display: flex;
        flex-direction: row;
        justify-content: space-evenly;
        align-items: center;
        flex-wrap: wrap;
      }
      .svgContainer {
        width: 100%;
        height: 600px;
        margin-bottom: 20px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }
      /* .svgContainer svg{
        background-color: rgb(47, 0, 255);
      } */
    </style>
  </head>
  <body>
    <h1>Test page</h1>

    <section class="actionsSection">
      <div class="action">
        <h3>Add range</h3>
        <div class="buttonContainer">
          <button class="MkM_Button">Add</button>
          <span>+</span>
        </div>
      </div>
      <div class="action">
        <h3>Remove range</h3>
        <div class="buttonContainer">
          <button class="MkM_Button">Remove First Added</button>
          <span>-</span>
        </div>
        <div class="buttonContainer">
          <button class="MkM_Button">Remove Last Added</button>
          <span>-</span>
        </div>
        <div class="buttonContainer">
          <button class="MkM_Button">Remove Middle</button>
          <span>-</span>
        </div>
      </div>
    </section>
    <main>
      <gx-gauge
        id="gxGauge"
        type="circle"
        min-value="0"
        value="2"
        show-value="true"
        thickness="20"
        show
        style="--component-height: 300px;--circle-text-color: rgba(250, 250, 250, 0.5);"
      >
        <gx-gauge-range
          amount="2"
          color="rgba(256, 116, 86, 1)"
        ></gx-gauge-range>
        <gx-gauge-range
          amount="1"
          color="rgba(256, 216, 106, 1)"
        ></gx-gauge-range>
        <gx-gauge-range
          amount="3"
          color="rgba(166, 216, 116, 1)"
        ></gx-gauge-range>
      </gx-gauge>
      <gx-gauge
        id="gxGauge2"
        type="line"
        min-value="0"
        value="2"
        show-value="true"
        thickness="10"
        style="--component-height: 50px;--circle-text-color: rgba(250, 250, 250, 0.5);"
      >
        <gx-gauge-range
          amount="2"
          color="rgba(256, 116, 86, 1)"
        ></gx-gauge-range>
        <gx-gauge-range
          amount="1"
          color="rgba(256, 216, 106, 1)"
        ></gx-gauge-range>
        <gx-gauge-range
          amount="3"
          color="rgba(166, 216, 116, 1)"
        ></gx-gauge-range>
      </gx-gauge>
    </main>
    <hr />
    <section id="chartContainer">
      <div class="svgContainer">
        Circles
        <svg
          id="circleGauge"
          width="100%"
          height="100%"
          viewBox="0 0 100 100"
          xmlns="http://www.w3.org/2000/svg"
          xlink="http://www.w3.org/1999/xlink"
        >
          <line
            x1="50"
            y1="0"
            x2="50"
            y2="100"
            stroke="black"
            stroke-width="0.2"
          />
          <line
            x1="0"
            y1="50"
            x2="100"
            y2="50"
            stroke="black"
            stroke-width="0.2"
          />
          <line
            x1="0"
            y1="0"
            x2="100"
            y2="100"
            stroke="black"
            stroke-width="0.2"
          />
          <line
            x1="100"
            y1="0"
            x2="0"
            y2="100"
            stroke="black"
            stroke-width="0.2"
          />
          <rect r="1" fill="rgba(0, 0, 0, 0.5)" width="100%" height="100%" />
          <circle id="circleTest0"></circle>
          <circle id="circleTest01"></circle>
          <circle id="circleTest1"></circle>
          <circle id="circleTest11"></circle>
          <circle id="circleTest2"></circle>
          <circle id="circleTest21"></circle>
          <circle id="circleTest3"></circle>
          <circle id="circleTest31"></circle>
          <circle id="circleTest4"></circle>
          <circle id="circleTest41"></circle>
        </svg>
        <script>
          (() => {
            const thickness = 20;
            const data = [
              { label: "data0", value: 50, color: "rgba(166, 216, 116, 1)" },
              { label: "data1", value: 33, color: "rgba(256, 216, 106, 1)" },
              { label: "data2", value: 66, color: "rgba(256, 156, 116, 1)" },
              { label: "data3", value: 90, color: "rgba(256, 116, 86, 1)" },
              { label: "data4", value: 95, color: "rgba(256, 46, 86, 1)" } /**/
            ];
            const thicknessToUse = thickness / data.length;
            const setRangeProps = (
              elements,
              radius,
              lineColor,
              lineWidth,
              percentage
            ) => {
              const circleLength = 2 * Math.PI * radius;
              function setGlobalProps(element, radius, lineColor) {
                element.setAttribute("r", radius);
                element.setAttribute("cx", 50);
                element.setAttribute("cy", 50);
                element.setAttribute("stroke", lineColor);
                element.setAttribute("fill", "none");
                element.setAttribute("stroke-linecap", "round");
              }

              setGlobalProps(elements[0], radius, lineColor);
              elements[0].setAttribute("style", "opacity: 0.5");
              elements[0].setAttribute("stroke-width", lineWidth);

              setGlobalProps(elements[1], radius, lineColor);
              elements[1].setAttribute("stroke-width", lineWidth / 2.5);
              elements[1].setAttribute("transform", "rotate(-90 50,50)");
              elements[1].setAttribute(
                "stroke-dasharray",
                `${circleLength * (percentage / 100)}, ${circleLength}`
              );
            };

            for (let [indX, dataItem] of data.entries()) {
              console.log(dataItem, indX);
              const circleRange = [
                document.getElementById(`circleTest${indX}`),
                document.getElementById(`circleTest${indX}1`)
              ];
              const rangeRadius =
                100 / 2 - thicknessToUse / 2 - thicknessToUse * indX;
              setRangeProps(
                circleRange,
                rangeRadius,
                dataItem.color,
                thicknessToUse,
                dataItem.value
              );
            }
          })();
        </script>
      </div>

      <div class="svgContainer">
        Line
        <svg
          width="100%"
          height="100%"
          viewBox="0 0 100 100"
          xmlns="http://www.w3.org/2000/svg"
          xlink="http://www.w3.org/1999/xlink"
        >
          <line
            x1="0"
            y1="0"
            x2="0"
            y2="100"
            stroke="black"
            stroke-width="0.5"
          />
          <line
            x1="25"
            y1="0"
            x2="25"
            y2="100"
            stroke="black"
            stroke-width="0.5"
          />
          <line
            x1="50"
            y1="0"
            x2="50"
            y2="100"
            stroke="black"
            stroke-width="0.5"
          />
          <line
            x1="100"
            y1="0"
            x2="100"
            y2="100"
            stroke="black"
            stroke-width="0.5"
          />
          <line
            x1="75"
            y1="0"
            x2="75"
            y2="100"
            stroke="black"
            stroke-width="0.5"
          />

          <line
            y1="0"
            x1="0"
            y2="0"
            x2="100"
            stroke="black"
            stroke-width="0.5"
          />
          <line
            y1="25"
            x1="0"
            y2="25"
            x2="100"
            stroke="black"
            stroke-width="0.5"
          />
          <line
            y1="50"
            x1="0"
            y2="50"
            x2="100"
            stroke="black"
            stroke-width="0.5"
          />
          <line
            y1="100"
            x1="0"
            y2="100"
            x2="100"
            stroke="black"
            stroke-width="0.5"
          />
          <line
            y1="75"
            x1="0"
            y2="75"
            x2="100"
            stroke="black"
            stroke-width="0.5"
          />

          <rect r="1" fill="rgba(0, 0, 0, 0.5)" width="100%" height="100%" />
          <line id="lineTest0" />
          <line id="lineTest01" />

          <line id="lineTest1" />
          <line id="lineTest11" />

          <line id="lineTest2" />
          <line id="lineTest21" />

          <line id="lineTest3" />
          <line id="lineTest31" />

          <line id="lineTest4" />
          <line id="lineTest41" />
          <!---->
        </svg>

        <script>
          (() => {
            const data = [
              { label: "data0", value: 50, color: "rgba(166, 216, 116, 1)" },
              { label: "data1", value: 33, color: "rgba(256, 216, 106, 1)" },
              { label: "data2", value: 66, color: "rgba(256, 156, 116, 1)" },
              { label: "data3", value: 90, color: "rgba(256, 116, 86, 1)" },
              { label: "data4", value: 95, color: "rgba(256, 46, 86, 1)" }
            ];

            const setRangeProps = (
              elements,
              startX,
              startY,
              lineColor,
              lineWidth,
              percentage
            ) => {
              const validPercentage =
                percentage >= 100 ? 100 : percentage <= 0 ? 0 : percentage;
              const sizeFix = {
                x: lineWidth / (lineWidth / 4.5),
                y: lineWidth / 2
              };
              function setGlobalProps(element, startX, startY, lineColor) {
                element.setAttribute("x1", startX + sizeFix.x); // 15 > 3.333333333333333333
                element.setAttribute("y1", startY); //+ sizeFix.y);
                element.setAttribute("y2", startY); //+ sizeFix.y);
                element.setAttribute("stroke", lineColor);
                element.setAttribute("stroke-linecap", "round");
              }

              setGlobalProps(elements[0], startX, startY, lineColor);
              elements[0].setAttribute("style", "opacity: 0.5");
              elements[0].setAttribute("stroke-width", lineWidth);
              elements[0].setAttribute("x2", 100 - sizeFix.x);

              setGlobalProps(elements[1], startX, startY, lineColor);
              elements[1].setAttribute("stroke-width", lineWidth / 3);
              elements[1].setAttribute("x2", validPercentage - sizeFix.x);
            };

            for (let [indX, dataItem] of data.entries()) {
              const lineRange = [
                document.getElementById(`lineTest${indX}`),
                document.getElementById(`lineTest${indX}1`)
              ];
              setRangeProps(
                lineRange,
                0,
                (100 / (data.length + 1)) * (indX + 1),
                dataItem.color,
                5,
                dataItem.value
              );
            }
          })();
        </script>
      </div>

      <div class="svgContainer">
        Path
        <svg
          width="100%"
          height="100%"
          viewBox="0 0 100 100"
          xmlns="http://www.w3.org/2000/svg"
          xlink="http://www.w3.org/1999/xlink"
        >
          <path
            id="arc1"
            fill="none"
            stroke="rgba(216, 216, 116, 0.6)"
            stroke-width="10"
          />
          <path
            id="arc2"
            fill="none"
            stroke="rgba(216, 216, 116, 1)"
            stroke-width="5"
            stroke-linecap="round"
          />

          <path
            id="arc21"
            fill="none"
            stroke="rgba(216, 150, 116, 0.6)"
            stroke-width="10"
          />
          <path
            id="arc22"
            fill="none"
            stroke="rgba(216, 150, 116, 1)"
            stroke-width="5"
            stroke-linecap="round"
          />

          <path
            id="arc31"
            fill="none"
            stroke="rgba(216, 116, 116, 0.6)"
            stroke-width="10"
          />
          <path
            id="arc32"
            fill="none"
            stroke="rgba(216, 116, 116, 1)"
            stroke-width="5"
            stroke-linecap="round"
          />
        </svg>

        <script>
          (() => {
            function polarToCartesian(
              centerX,
              centerY,
              radius,
              angleInDegrees
            ) {
              const validAngle =
                angleInDegrees >= 360
                  ? 359.999
                  : angleInDegrees <= 0
                  ? 0
                  : angleInDegrees;
              var angleInRadians = ((validAngle - 90) * Math.PI) / 180.0;

              return {
                x: centerX + radius * Math.cos(angleInRadians),
                y: centerY + radius * Math.sin(angleInRadians)
              };
            }

            function describeArc(x, y, radius, startAngle, endAngle) {
              var start = polarToCartesian(x, y, radius, endAngle);
              var end = polarToCartesian(x, y, radius, startAngle);
              var largeArcFlag = endAngle - startAngle <= 180 ? "0" : "1";
              var d = [
                "M",
                start.x,
                start.y,
                "A",
                radius,
                radius,
                0,
                largeArcFlag,
                0,
                end.x,
                end.y
              ].join(" ");

              return d;
            }
            document
              .getElementById("arc1")
              .setAttribute("d", describeArc(50, 50, 40, 0, 360));
            document
              .getElementById("arc2")
              .setAttribute("d", describeArc(50, 50, 40, 0, 180));
            document
              .getElementById("arc21")
              .setAttribute("d", describeArc(50, 50, 30, 0, 360));
            document
              .getElementById("arc22")
              .setAttribute("d", describeArc(50, 50, 30, 0, 240));
            document
              .getElementById("arc31")
              .setAttribute("d", describeArc(50, 50, 20, 0, 360));
            document
              .getElementById("arc32")
              .setAttribute("d", describeArc(50, 50, 20, 0, 180));
          })();
        </script>
      </div>
    </section>

    <!---->
  </body>
  <script>
    (() => {
      const gauge1 = document.getElementById("gxGauge");
      const gauge2 = document.getElementById("gxGauge2");
      function addRange2(randomColor, randomRangeAmount) {
        const gaugeRangeList2 = gauge2.querySelectorAll("gx-gauge-range");
        const newGaugeRange = document.createElement("gx-gauge-range");
        console.log(randomColor);

        newGaugeRange.setAttribute("amount", randomRangeAmount);
        newGaugeRange.setAttribute("color", randomColor);
        gauge2.appendChild(newGaugeRange);
      }
      function addRange1() {
        const gaugeRangeList1 = gauge1.querySelectorAll("gx-gauge-range");
        const newGaugeRange = document.createElement("gx-gauge-range");
        const randomColor = `rgba(${Math.round(
          Math.random() * 255
        )}, ${Math.round(Math.random() * 255)}, ${Math.round(
          Math.random() * 255
        )}, ${Math.random() * 1 + 0.2})`;
        const randomRangeAmount = Math.round(Math.random() * 4) + 1;

        newGaugeRange.setAttribute("amount", randomRangeAmount);
        newGaugeRange.setAttribute("color", randomColor);
        gauge1.appendChild(newGaugeRange);
        addRange2(randomColor, randomRangeAmount);
      }
      function removeFirstRange() {
        const gaugeRangeList1 = gauge1.querySelectorAll("gx-gauge-range");
        const gaugeRangeList2 = gauge2.querySelectorAll("gx-gauge-range");
        gauge1.removeChild(gaugeRangeList1[0]);
        gauge2.removeChild(gaugeRangeList2[0]);
      }
      function removeLastRange() {
        const gaugeRangeList1 = gauge1.querySelectorAll("gx-gauge-range");
        const gaugeRangeList2 = gauge2.querySelectorAll("gx-gauge-range");
        gauge1.removeChild(gaugeRangeList1[gaugeRangeList1.length - 1]);
        gauge2.removeChild(gaugeRangeList2[gaugeRangeList2.length - 1]);
      }
      // var ctx = document.getElementById('myChart').getContext('2d');
      // var myChart = new Chart(ctx, {
      // 	type: 'doughnut',
      // 	data: {
      // 		labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
      // 		datasets: [{
      // 			label: '# of Votes',
      // 			data: [12, 19, 3, 5, 2, 3],
      // 			backgroundColor: [
      // 				'rgba(255, 99, 132, 0.2)',
      // 				'rgba(54, 162, 235, 0.2)',
      // 				'rgba(255, 206, 86, 0.2)',
      // 				'rgba(75, 192, 192, 0.2)',
      // 				'rgba(153, 102, 255, 0.2)',
      // 				'rgba(255, 159, 64, 0.2)'
      // 			],
      // 			borderColor: [
      // 				'rgba(255, 99, 132, 1)',
      // 				'rgba(54, 162, 235, 1)',
      // 				'rgba(255, 206, 86, 1)',
      // 				'rgba(75, 192, 192, 1)',
      // 				'rgba(153, 102, 255, 1)',
      // 				'rgba(255, 159, 64, 1)'
      // 			],
      // 			borderWidth: 2
      // 		}]
      // 	},
      // 	options: {

      // 	}
      // });

      document
        .getElementsByClassName("MkM_Button")[0]
        .addEventListener("click", addRange1);
      document
        .getElementsByClassName("MkM_Button")[1]
        .addEventListener("click", removeFirstRange);
      document
        .getElementsByClassName("MkM_Button")[2]
        .addEventListener("click", removeLastRange);
      document
        .getElementsByClassName("MkM_Button")[3]
        .addEventListener("click", removeFirstRange);
    })();
  </script>
</html>
