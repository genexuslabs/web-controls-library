@import "../common/_base";
@import "../common/_image-position";

@mixin imageMargin($position, $value) {
  &.gx-image-position--#{$position} {
    [slot="main-image"],
    [slot="disabled-image"] {
      @if ($position == "before" or $position == "after") {
        margin: 0 $value;
      }
      @if ($position == "above" or $position == "below") {
        margin: $value 0;
      }
    }
  }
}

@mixin tabsPosition(
  $paddingTop: calc(var(--tab-caption-vertical-padding) - 3px),
  $paddingBottom: calc(var(--tab-caption-vertical-padding) - 1px),
  $borderTop: 3px solid transparent,
  $borderBottom: 1px solid var(--tab-strip-separator-color),
  $borderTopColorActive: var(--tab-strip-indicator-color),
  $borderBottomColorActive: transparent
) {
  gx-tab-caption {
    &.gx-tab-caption {
      .gx-nav-link {
        padding: $paddingTop var(--tab-caption-horizontal-padding)
          $paddingBottom var(--tab-caption-horizontal-padding);

        border-top: $borderTop;
        border-bottom: $borderBottom;
      }

      &--active {
        .gx-nav-link {
          border-top-color: $borderTopColorActive;
          border-bottom-color: $borderBottomColorActive;
        }
      }
    }
  }
}

// Used to show the captions in the top position
[data-position="top"] {
  @include tabsPosition;
}

// Used to show the captions in the bottom position
[data-position="bottom"] {
  @include tabsPosition(
    calc(var(--tab-caption-vertical-padding) - 1px),
    calc(var(--tab-caption-vertical-padding) - 3px),
    1px solid var(--tab-strip-separator-color),
    3px solid transparent,
    transparent,
    var(--tab-strip-indicator-color)
  );
}

gx-tab-caption {
  @include visibility(table-cell);

  @include imageMargin("before", var(--tab-caption-image-vertical-margin));
  @include imageMargin("after", var(--tab-caption-image-vertical-margin));
  @include imageMargin("above", var(--tab-caption-image-horizontal-margin));
  @include imageMargin("below", var(--tab-caption-image-horizontal-margin));

  // Used to decide the position of the image
  @include imagePosition(
    ".image-and-link-container a",
    ":not(.gx-tab-caption--active)"
  );

  // Used to limit the sizes of the images
  [slot="main-image"],
  [slot="disabled-image"] {
    max-height: 18px;
    max-width: 18px;
    object-fit: contain;
  }

  background-color: inherit;
  font-size: 12px;
  font-weight: 600;

  &.gx-tab-caption {
    height: 100%;
    transition: filter var(--tab-delay-transition-color);

    .image-and-link-container {
      display: inline-block;
      vertical-align: top;
      height: 100%;
      background-color: inherit;

      .gx-nav-link {
        display: flex;
        height: 100%;
        color: inherit;
        background-color: inherit;
        transition: background-color var(--tab-delay-transition-color),
          color var(--tab-delay-transition-color),
          border-color var(--tab-delay-transition-color);
        white-space: nowrap;

        &:active,
        &:focus,
        &:hover,
        &:visited {
          color: none;
          text-decoration: none;
          outline: 0;
        }

        & > span {
          display: flex;
          align-items: center;
          height: 100%;
          padding-top: 0.125em;
          transition: filter var(--tab-delay-transition-color);
        }
      }
    }

    &[aria-selected="false"]:hover:not(:active) {
      filter: brightness(90%);
    }

    &--disabled {
      pointer-events: none;

      .image-and-link-container {
        .gx-nav-link {
          & > span {
            filter: opacity(0.5);
          }
        }
      }
    }
  }
}
